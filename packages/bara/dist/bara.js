!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.bara=n():t.bara=n()}(window,function(){return function(t){var n={};function e(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,e),o.l=!0,o.exports}return e.m=t,e.c=n,e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:i})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(e.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var o in t)e.d(i,o,function(n){return t[n]}.bind(null,o));return i},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=1)}([function(t,n,e){"use strict";function i(t){var n,e=t.Symbol;return"function"==typeof e?e.observable?n=e.observable:(n=e("observable"),e.observable=n):n="@@observable",n}e.d(n,"a",function(){return i})},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const i=e(2),{register:o,useStream:r,useTrigger:s,useEvent:u,useCondition:h,useAction:p}=i;n.register=o,n.useStream=r,n.useTrigger=s,n.useEvent=u,n.useCondition=h,n.useAction=p,n.default=i},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),function(t){for(var e in t)n.hasOwnProperty(e)||(n[e]=t[e])}(e(3))},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const i=e(4);const{register:o,useStream:r,useTrigger:s,useEvent:u,useCondition:h,useAction:p}=function(){const t=[],n={};return{register:t=>{!function(t){t()}(t)},useStream:(n,e)=>{const o=n.name;let r;if(function({name:n}){return t.filter(t=>t[0]===n).length>0}(n))r=t[o],console.warn(`[Bara Stream] Warning: The stream ${o} has been duplicate registered, please remove redundant code!`);else{r=i.default.create({start:t=>{const e=t.error,i=t.complete;n.setup({emit:(n,e)=>{t.next({eventType:n,payload:e})},error:e,done:i})},stop:()=>{}});const e=n.eventTypes;t.push([o,{eventTypes:e,config:n,stream:r}])}return[r]},useTrigger:t=>{const e=t.name;if(Boolean(e in n))throw new Error(`[Bara Trigger] Error: Duplicate trigger name ${e} in the registry, please specify different name!`);n[e]={config:t},n[e].config.event(e)},useEvent:(e,i)=>i=>{const o=n[i],r=t.find(t=>t[1].eventTypes.indexOf(e)>-1);r?(console.debug(`[Bara Event] Found stream ${r[0]} of event types ${e}`),r[1].stream.filter(t=>!("condition"in o.config)||o.config.condition(t)).subscribe({next:t=>{o.config.action(t)}})):console.warn(`[Bara Event] Not found any stream that will emit event type: ${e}`),console.debug(`[Bara Event] Registered ${e} from ${i}`)},useCondition:t=>n=>t(n),useAction:t=>n=>{t(n)}}}();n.register=o,n.useStream=r,n.useTrigger=s,n.useEvent=u,n.useCondition=h,n.useAction=p},function(t,n,e){"use strict";var i,o=this&&this.__extends||(i=function(t,n){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(t,n)},function(t,n){function e(){this.constructor=t}i(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)});Object.defineProperty(n,"__esModule",{value:!0});var r=e(5),s={};function u(){}function h(t){for(var n=t.length,e=Array(n),i=0;i<n;++i)e[i]=t[i];return e}function p(t,n,e){try{return t.f(n)}catch(t){return e._e(t),s}}n.NO=s;var c={_n:u,_e:u,_c:u};function f(t){t._start=function(t){t.next=t._n,t.error=t._e,t.complete=t._c,this.start(t)},t._stop=t.stop}n.NO_IL=c;var a=function(){function t(t,n){this._stream=t,this._listener=n}return t.prototype.unsubscribe=function(){this._stream._remove(this._listener)},t}(),_=function(){function t(t){this._listener=t}return t.prototype.next=function(t){this._listener._n(t)},t.prototype.error=function(t){this._listener._e(t)},t.prototype.complete=function(){this._listener._c()},t}(),l=function(){function t(t){this.type="fromObservable",this.ins=t,this.active=!1}return t.prototype._start=function(t){this.out=t,this.active=!0,this._sub=this.ins.subscribe(new _(t)),this.active||this._sub.unsubscribe()},t.prototype._stop=function(){this._sub&&this._sub.unsubscribe(),this.active=!1},t}(),y=function(){function t(t){this.type="merge",this.insArr=t,this.out=s,this.ac=0}return t.prototype._start=function(t){this.out=t;var n=this.insArr,e=n.length;this.ac=e;for(var i=0;i<e;i++)n[i]._add(this)},t.prototype._stop=function(){for(var t=this.insArr,n=t.length,e=0;e<n;e++)t[e]._remove(this);this.out=s},t.prototype._n=function(t){var n=this.out;n!==s&&n._n(t)},t.prototype._e=function(t){var n=this.out;n!==s&&n._e(t)},t.prototype._c=function(){if(--this.ac<=0){var t=this.out;if(t===s)return;t._c()}},t}(),d=function(){function t(t,n,e){this.i=t,this.out=n,this.p=e,e.ils.push(this)}return t.prototype._n=function(t){var n=this.p,e=this.out;if(e!==s&&n.up(t,this.i)){for(var i=n.vals,o=i.length,r=Array(o),u=0;u<o;++u)r[u]=i[u];e._n(r)}},t.prototype._e=function(t){var n=this.out;n!==s&&n._e(t)},t.prototype._c=function(){var t=this.p;t.out!==s&&0==--t.Nc&&t.out._c()},t}(),v=function(){function t(t){this.type="combine",this.insArr=t,this.out=s,this.ils=[],this.Nc=this.Nn=0,this.vals=[]}return t.prototype.up=function(t,n){var e=this.vals[n],i=this.Nn?e===s?--this.Nn:this.Nn:0;return this.vals[n]=t,0===i},t.prototype._start=function(t){this.out=t;var n=this.insArr,e=this.Nc=this.Nn=n.length,i=this.vals=new Array(e);if(0===e)t._n([]),t._c();else for(var o=0;o<e;o++)i[o]=s,n[o]._add(new d(o,t,this))},t.prototype._stop=function(){for(var t=this.insArr,n=t.length,e=this.ils,i=0;i<n;i++)t[i]._remove(e[i]);this.out=s,this.ils=[],this.vals=[]},t}(),m=function(){function t(t){this.type="fromArray",this.a=t}return t.prototype._start=function(t){for(var n=this.a,e=0,i=n.length;e<i;e++)t._n(n[e]);t._c()},t.prototype._stop=function(){},t}(),b=function(){function t(t){this.type="fromPromise",this.on=!1,this.p=t}return t.prototype._start=function(t){var n=this;this.on=!0,this.p.then(function(e){n.on&&(t._n(e),t._c())},function(n){t._e(n)}).then(u,function(t){setTimeout(function(){throw t})})},t.prototype._stop=function(){this.on=!1},t}(),w=function(){function t(t){this.type="periodic",this.period=t,this.intervalID=-1,this.i=0}return t.prototype._start=function(t){var n=this;this.intervalID=setInterval(function(){t._n(n.i++)},this.period)},t.prototype._stop=function(){-1!==this.intervalID&&clearInterval(this.intervalID),this.intervalID=-1,this.i=0},t}(),g=function(){function t(t,n){this.type="debug",this.ins=t,this.out=s,this.s=u,this.l="","string"==typeof n?this.l=n:"function"==typeof n&&(this.s=n)}return t.prototype._start=function(t){this.out=t,this.ins._add(this)},t.prototype._stop=function(){this.ins._remove(this),this.out=s},t.prototype._n=function(t){var n=this.out;if(n!==s){var e=this.s,i=this.l;if(e!==u)try{e(t)}catch(t){n._e(t)}else i?console.log(i+":",t):console.log(t);n._n(t)}},t.prototype._e=function(t){var n=this.out;n!==s&&n._e(t)},t.prototype._c=function(){var t=this.out;t!==s&&t._c()},t}(),x=function(){function t(t,n){this.type="drop",this.ins=n,this.out=s,this.max=t,this.dropped=0}return t.prototype._start=function(t){this.out=t,this.dropped=0,this.ins._add(this)},t.prototype._stop=function(){this.ins._remove(this),this.out=s},t.prototype._n=function(t){var n=this.out;n!==s&&this.dropped++>=this.max&&n._n(t)},t.prototype._e=function(t){var n=this.out;n!==s&&n._e(t)},t.prototype._c=function(){var t=this.out;t!==s&&t._c()},t}(),O=function(){function t(t,n){this.out=t,this.op=n}return t.prototype._n=function(){this.op.end()},t.prototype._e=function(t){this.out._e(t)},t.prototype._c=function(){this.op.end()},t}(),A=function(){function t(t,n){this.type="endWhen",this.ins=n,this.out=s,this.o=t,this.oil=c}return t.prototype._start=function(t){this.out=t,this.o._add(this.oil=new O(t,this)),this.ins._add(this)},t.prototype._stop=function(){this.ins._remove(this),this.o._remove(this.oil),this.out=s,this.oil=c},t.prototype.end=function(){var t=this.out;t!==s&&t._c()},t.prototype._n=function(t){var n=this.out;n!==s&&n._n(t)},t.prototype._e=function(t){var n=this.out;n!==s&&n._e(t)},t.prototype._c=function(){this.end()},t}(),S=function(){function t(t,n){this.type="filter",this.ins=n,this.out=s,this.f=t}return t.prototype._start=function(t){this.out=t,this.ins._add(this)},t.prototype._stop=function(){this.ins._remove(this),this.out=s},t.prototype._n=function(t){var n=this.out;if(n!==s){var e=p(this,t,n);e!==s&&e&&n._n(t)}},t.prototype._e=function(t){var n=this.out;n!==s&&n._e(t)},t.prototype._c=function(){var t=this.out;t!==s&&t._c()},t}(),T=function(){function t(t,n){this.out=t,this.op=n}return t.prototype._n=function(t){this.out._n(t)},t.prototype._e=function(t){this.out._e(t)},t.prototype._c=function(){this.op.inner=s,this.op.less()},t}(),j=function(){function t(t){this.type="flatten",this.ins=t,this.out=s,this.open=!0,this.inner=s,this.il=c}return t.prototype._start=function(t){this.out=t,this.open=!0,this.inner=s,this.il=c,this.ins._add(this)},t.prototype._stop=function(){this.ins._remove(this),this.inner!==s&&this.inner._remove(this.il),this.out=s,this.open=!0,this.inner=s,this.il=c},t.prototype.less=function(){var t=this.out;t!==s&&(this.open||this.inner!==s||t._c())},t.prototype._n=function(t){var n=this.out;if(n!==s){var e=this.inner,i=this.il;e!==s&&i!==c&&e._remove(i),(this.inner=t)._add(this.il=new T(n,this))}},t.prototype._e=function(t){var n=this.out;n!==s&&n._e(t)},t.prototype._c=function(){this.open=!1,this.less()},t}(),P=function(){function t(t,n,e){var i=this;this.type="fold",this.ins=e,this.out=s,this.f=function(n){return t(i.acc,n)},this.acc=this.seed=n}return t.prototype._start=function(t){this.out=t,this.acc=this.seed,t._n(this.acc),this.ins._add(this)},t.prototype._stop=function(){this.ins._remove(this),this.out=s,this.acc=this.seed},t.prototype._n=function(t){var n=this.out;if(n!==s){var e=p(this,t,n);e!==s&&n._n(this.acc=e)}},t.prototype._e=function(t){var n=this.out;n!==s&&n._e(t)},t.prototype._c=function(){var t=this.out;t!==s&&t._c()},t}(),N=function(){function t(t){this.type="last",this.ins=t,this.out=s,this.has=!1,this.val=s}return t.prototype._start=function(t){this.out=t,this.has=!1,this.ins._add(this)},t.prototype._stop=function(){this.ins._remove(this),this.out=s,this.val=s},t.prototype._n=function(t){this.has=!0,this.val=t},t.prototype._e=function(t){var n=this.out;n!==s&&n._e(t)},t.prototype._c=function(){var t=this.out;t!==s&&(this.has?(t._n(this.val),t._c()):t._e(new Error("last() failed because input stream completed")))},t}(),E=function(){function t(t,n){this.type="map",this.ins=n,this.out=s,this.f=t}return t.prototype._start=function(t){this.out=t,this.ins._add(this)},t.prototype._stop=function(){this.ins._remove(this),this.out=s},t.prototype._n=function(t){var n=this.out;if(n!==s){var e=p(this,t,n);e!==s&&n._n(e)}},t.prototype._e=function(t){var n=this.out;n!==s&&n._e(t)},t.prototype._c=function(){var t=this.out;t!==s&&t._c()},t}(),I=function(){function t(t){this.type="remember",this.ins=t,this.out=s}return t.prototype._start=function(t){this.out=t,this.ins._add(t)},t.prototype._stop=function(){this.ins._remove(this.out),this.out=s},t}(),D=function(){function t(t,n){this.type="replaceError",this.ins=n,this.out=s,this.f=t}return t.prototype._start=function(t){this.out=t,this.ins._add(this)},t.prototype._stop=function(){this.ins._remove(this),this.out=s},t.prototype._n=function(t){var n=this.out;n!==s&&n._n(t)},t.prototype._e=function(t){var n=this.out;if(n!==s)try{this.ins._remove(this),(this.ins=this.f(t))._add(this)}catch(t){n._e(t)}},t.prototype._c=function(){var t=this.out;t!==s&&t._c()},t}(),k=function(){function t(t,n){this.type="startWith",this.ins=t,this.out=s,this.val=n}return t.prototype._start=function(t){this.out=t,this.out._n(this.val),this.ins._add(t)},t.prototype._stop=function(){this.ins._remove(this.out),this.out=s},t}(),M=function(){function t(t,n){this.type="take",this.ins=n,this.out=s,this.max=t,this.taken=0}return t.prototype._start=function(t){this.out=t,this.taken=0,this.max<=0?t._c():this.ins._add(this)},t.prototype._stop=function(){this.ins._remove(this),this.out=s},t.prototype._n=function(t){var n=this.out;if(n!==s){var e=++this.taken;e<this.max?n._n(t):e===this.max&&(n._n(t),n._c())}},t.prototype._e=function(t){var n=this.out;n!==s&&n._e(t)},t.prototype._c=function(){var t=this.out;t!==s&&t._c()},t}(),W=function(){function t(t){this._prod=t||s,this._ils=[],this._stopID=s,this._dl=s,this._d=!1,this._target=s,this._err=s}return t.prototype._n=function(t){var n=this._ils,e=n.length;if(this._d&&this._dl._n(t),1==e)n[0]._n(t);else{if(0==e)return;for(var i=h(n),o=0;o<e;o++)i[o]._n(t)}},t.prototype._e=function(t){if(this._err===s){this._err=t;var n=this._ils,e=n.length;if(this._x(),this._d&&this._dl._e(t),1==e)n[0]._e(t);else{if(0==e)return;for(var i=h(n),o=0;o<e;o++)i[o]._e(t)}if(!this._d&&0==e)throw this._err}},t.prototype._c=function(){var t=this._ils,n=t.length;if(this._x(),this._d&&this._dl._c(),1==n)t[0]._c();else{if(0==n)return;for(var e=h(t),i=0;i<n;i++)e[i]._c()}},t.prototype._x=function(){0!==this._ils.length&&(this._prod!==s&&this._prod._stop(),this._err=s,this._ils=[])},t.prototype._stopNow=function(){this._prod._stop(),this._err=s,this._stopID=s},t.prototype._add=function(t){var n=this._target;if(n!==s)return n._add(t);var e=this._ils;if(e.push(t),!(e.length>1))if(this._stopID!==s)clearTimeout(this._stopID),this._stopID=s;else{var i=this._prod;i!==s&&i._start(this)}},t.prototype._remove=function(t){var n=this,e=this._target;if(e!==s)return e._remove(t);var i=this._ils,o=i.indexOf(t);o>-1&&(i.splice(o,1),this._prod!==s&&i.length<=0?(this._err=s,this._stopID=setTimeout(function(){return n._stopNow()})):1===i.length&&this._pruneCycles())},t.prototype._pruneCycles=function(){this._hasNoSinks(this,[])&&this._remove(this._ils[0])},t.prototype._hasNoSinks=function(t,n){if(-1!==n.indexOf(t))return!0;if(t.out===this)return!0;if(t.out&&t.out!==s)return this._hasNoSinks(t.out,n.concat(t));if(t._ils){for(var e=0,i=t._ils.length;e<i;e++)if(!this._hasNoSinks(t._ils[e],n.concat(t)))return!1;return!0}return!1},t.prototype.ctor=function(){return this instanceof C?C:t},t.prototype.addListener=function(t){t._n=t.next||u,t._e=t.error||u,t._c=t.complete||u,this._add(t)},t.prototype.removeListener=function(t){this._remove(t)},t.prototype.subscribe=function(t){return this.addListener(t),new a(this,t)},t.prototype[r.default]=function(){return this},t.create=function(n){if(n){if("function"!=typeof n.start||"function"!=typeof n.stop)throw new Error("producer requires both start and stop functions");f(n)}return new t(n)},t.createWithMemory=function(t){return t&&f(t),new C(t)},t.never=function(){return new t({_start:u,_stop:u})},t.empty=function(){return new t({_start:function(t){t._c()},_stop:u})},t.throw=function(n){return new t({_start:function(t){t._e(n)},_stop:u})},t.from=function(n){if("function"==typeof n[r.default])return t.fromObservable(n);if("function"==typeof n.then)return t.fromPromise(n);if(Array.isArray(n))return t.fromArray(n);throw new TypeError("Type of input to from() must be an Array, Promise, or Observable")},t.of=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return t.fromArray(n)},t.fromArray=function(n){return new t(new m(n))},t.fromPromise=function(n){return new t(new b(n))},t.fromObservable=function(n){if(n.endWhen)return n;var e="function"==typeof n[r.default]?n[r.default]():n;return new t(new l(e))},t.periodic=function(n){return new t(new w(n))},t.prototype._map=function(t){return new(this.ctor())(new E(t,this))},t.prototype.map=function(t){return this._map(t)},t.prototype.mapTo=function(t){var n=this.map(function(){return t});return n._prod.type="mapTo",n},t.prototype.filter=function(n){var e,i,o=this._prod;return new t(o instanceof S?new S((e=o.f,i=n,function(t){return e(t)&&i(t)}),o.ins):new S(n,this))},t.prototype.take=function(t){return new(this.ctor())(new M(t,this))},t.prototype.drop=function(n){return new t(new x(n,this))},t.prototype.last=function(){return new t(new N(this))},t.prototype.startWith=function(t){return new C(new k(this,t))},t.prototype.endWhen=function(t){return new(this.ctor())(new A(t,this))},t.prototype.fold=function(t,n){return new C(new P(t,n,this))},t.prototype.replaceError=function(t){return new(this.ctor())(new D(t,this))},t.prototype.flatten=function(){return new t(new j(this))},t.prototype.compose=function(t){return t(this)},t.prototype.remember=function(){return new C(new I(this))},t.prototype.debug=function(t){return new(this.ctor())(new g(this,t))},t.prototype.imitate=function(t){if(t instanceof C)throw new Error("A MemoryStream was given to imitate(), but it only supports a Stream. Read more about this restriction here: https://github.com/staltz/xstream#faq");this._target=t;for(var n=this._ils,e=n.length,i=0;i<e;i++)t._add(n[i]);this._ils=[]},t.prototype.shamefullySendNext=function(t){this._n(t)},t.prototype.shamefullySendError=function(t){this._e(t)},t.prototype.shamefullySendComplete=function(){this._c()},t.prototype.setDebugListener=function(t){t?(this._d=!0,t._n=t.next||u,t._e=t.error||u,t._c=t.complete||u,this._dl=t):(this._d=!1,this._dl=s)},t.merge=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return new t(new y(n))},t.combine=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return new t(new v(n))},t}();n.Stream=W;var C=function(t){function n(n){var e=t.call(this,n)||this;return e._has=!1,e}return o(n,t),n.prototype._n=function(n){this._v=n,this._has=!0,t.prototype._n.call(this,n)},n.prototype._add=function(t){var n=this._target;if(n!==s)return n._add(t);var e=this._ils;if(e.push(t),e.length>1)this._has&&t._n(this._v);else if(this._stopID!==s)this._has&&t._n(this._v),clearTimeout(this._stopID),this._stopID=s;else if(this._has)t._n(this._v);else{var i=this._prod;i!==s&&i._start(this)}},n.prototype._stopNow=function(){this._has=!1,t.prototype._stopNow.call(this)},n.prototype._x=function(){this._has=!1,t.prototype._x.call(this)},n.prototype.map=function(t){return this._map(t)},n.prototype.mapTo=function(n){return t.prototype.mapTo.call(this,n)},n.prototype.take=function(n){return t.prototype.take.call(this,n)},n.prototype.endWhen=function(n){return t.prototype.endWhen.call(this,n)},n.prototype.replaceError=function(n){return t.prototype.replaceError.call(this,n)},n.prototype.remember=function(){return this},n.prototype.debug=function(n){return t.prototype.debug.call(this,n)},n}(W);n.MemoryStream=C;var $=W;n.default=$},function(t,n,e){"use strict";e.r(n),function(t,i){var o,r=e(0);o="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t?t:i;var s=Object(r.a)(o);n.default=s}.call(this,e(6),e(7)(t))},function(t,n){var e;e=function(){return this}();try{e=e||new Function("return this")()}catch(t){"object"==typeof window&&(e=window)}t.exports=e},function(t,n){t.exports=function(t){if(!t.webpackPolyfill){var n=Object.create(t);n.children||(n.children=[]),Object.defineProperty(n,"loaded",{enumerable:!0,get:function(){return n.l}}),Object.defineProperty(n,"id",{enumerable:!0,get:function(){return n.i}}),Object.defineProperty(n,"exports",{enumerable:!0}),n.webpackPolyfill=1}return n}}])});